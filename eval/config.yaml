# ============================================================
# VisDrone2019 RT-DETR Model Evaluation Configuration
# ============================================================

# Workspace root (auto-detected, override if needed)
workspace_root: "."

# ============ Dataset Paths (relative to workspace root) ============
datasets:
  val:
    images_dir: "VisDrone Val image set"
    annotations: "VisDrone Val image set/annotations_VisDrone_val.json"
  test:
    images_dir: "VisDrone test image set/images"

# ============ Output Directory ============
output_dir: "eval/results"

# ============ VisDrone Classes (10 classes) ============
class_names:
  - pedestrian
  - people
  - bicycle
  - car
  - van
  - truck
  - tricycle
  - awning-tricycle
  - bus
  - motor

# ============ Model Configurations ============
# decoder_layers: 3 = CRR (correct), 6 = non-CRR
models:
  # --- Baseline ---
  baseline_rtdetr_r18:
    name: "RT-DETR R18 Baseline"
    path: "Checkpoints - Baseline_Visdrone2019/RT-DETR Resnet 18/base_rtdetr.onnx"
    decoder_layers: 3
    backbone: "ResNet-18"
    category: "baseline"
    description: "Baseline RT-DETR with ResNet-18 backbone"

  # --- Improvement 1: P2-P3 Fusion ---
  p2p3_fusion:
    name: "P2-P3 Fusion"
    path: "Checkpoints - After improvements/1-P2-P3 fusion/model_p2p3_F.onnx"
    decoder_layers: 3
    backbone: "ResNet-18"
    category: "neck"
    description: "P2-P3 feature fusion in neck"

  # --- Improvement 2: Query Importance ---
  query_imp:
    name: "Query Importance"
    path: "Checkpoints - After improvements/2-Query IMP/model (1).onnx"
    decoder_layers: 3
    backbone: "ResNet-18"
    category: "decoder"
    description: "Improved query selection mechanism"

  # --- Improvement 3: Aware Loss Reweighting ---
  aware_loss:
    name: "Aware Loss Reweighting"
    path: "Checkpoints - After improvements/3- Aware Loss Reweighting/model (1).onnx"
    decoder_layers: 3
    backbone: "ResNet-18"
    category: "training"
    description: "Class/scale-aware loss reweighting"

  # --- Improvement 5: gnconv ---
  gnconv:
    name: "gnConv"
    path: "Checkpoints - After improvements/5 - gnconv/model (1).onnx"
    decoder_layers: 3
    backbone: "ResNet-18"
    category: "backbone"
    description: "Global/gated convolutions (HorNet-style)"

  # --- Improvement 6: P2 Layer ---
  p2_layer:
    name: "P2 Layer"
    path: "Checkpoints - After improvements/6 - p2 layer/model (2).onnx"
    decoder_layers: 3
    backbone: "ResNet-18"
    category: "neck"
    description: "Additional high-resolution P2 detection layer"

  # --- Improvement 6_1: SLIM P2 Layer (Channel-reduced) ---
  slim_p2_c:
    name: "SLIM P2 (Channel)"
    path: "Checkpoints - After improvements/6_1 - SLIM p2 layer C/model (2).onnx"
    decoder_layers: 3
    backbone: "ResNet-18"
    category: "neck"
    description: "Slim P2 layer - channel reduced variant"

  # --- Improvement 6_1: SLIM P2 Layer (Inception) ---
  slim_p2_inc:
    name: "SLIM P2 (Inception)"
    path: "Checkpoints - After improvements/6_1 - SLIM p2 layer INC/model (2).onnx"
    decoder_layers: 6
    backbone: "ResNet-18"
    category: "neck"
    description: "Slim P2 layer - inception variant"

  # --- Improvement 7: gnconv + P2 Layer (6 decoders) ---
  gnconv_p2:
    name: "gnConv + P2 (6-dec)"
    path: "Checkpoints - After improvements/7 - gnconv + p2 layer/model (2).onnx"
    decoder_layers: 6
    backbone: "ResNet-18"
    category: "combined"
    description: "gnConv + P2 layer with 6 decoder layers"

  # --- Improvement 7: gnconv + P2 Layer CRR (3 decoders) ---
  gnconv_p2_crr:
    name: "gnConv + P2 (3-dec)"
    path: "Checkpoints - After improvements/7 - gnconv + p2 layer CRR/model (2).onnx"
    decoder_layers: 3
    backbone: "ResNet-18"
    category: "combined"
    description: "gnConv + P2 layer with 3 decoder layers (correct)"

  # --- Improvement 7_1: gnconv + P2 + RepVGG (6 decoders) ---
  gnconv_p2_repvgg:
    name: "gnConv + P2 + RepVGG (6-dec)"
    path: "Checkpoints - After improvements/7_1 - gnconv + p2 layer + Repvgg/model (2).onnx"
    decoder_layers: 6
    backbone: "ResNet-18"
    category: "combined"
    description: "gnConv + P2 + RepVGG with 6 decoder layers"

  # --- Improvement 7_1: gnconv + P2 + RepVGG CRR (3 decoders) ---
  gnconv_p2_repvgg_crr:
    name: "gnConv + P2 + RepVGG (3-dec)"
    path: "Checkpoints - After improvements/7_1 - gnconv + p2 layer + Repvgg CRR/model (2).onnx"
    decoder_layers: 3
    backbone: "ResNet-18"
    category: "combined"
    description: "gnConv + P2 + RepVGG with 3 decoder layers (correct)"

  # --- Improvement 7_2: gnconv + SLIM P2 + RepVGG (6 decoders) ---
  gnconv_slim_p2_repvgg:
    name: "gnConv + SLIM-P2 + RepVGG (6-dec)"
    path: "Checkpoints - After improvements/7_2 - gnconv + SLIM p2 layer + Repvgg/model (2).onnx"
    decoder_layers: 6
    backbone: "ResNet-18"
    category: "combined"
    description: "gnConv + SLIM P2 + RepVGG with 6 decoder layers"

  # --- Improvement 7_2: gnconv + SLIM P2 + RepVGG CRR (3 decoders) ---
  gnconv_slim_p2_repvgg_crr:
    name: "gnConv + SLIM-P2 + RepVGG (3-dec)"
    path: "Checkpoints - After improvements/7_2 - gnconv + SLIM p2 layer + Repvgg CRR/model (2).onnx"
    decoder_layers: 3
    backbone: "ResNet-18"
    category: "combined"
    description: "gnConv + SLIM P2 + RepVGG with 3 decoder layers (correct)"

  # --- Improvement 8: gnConV+P2 integrated ---
  gnconv_p2_integrated:
    name: "(gnConV+P2) Integrated"
    path: "Checkpoints - After improvements/8 - (gnConV+p2)/model (2).onnx"
    decoder_layers: 3
    backbone: "ResNet-18"
    category: "combined"
    description: "Integrated gnConv + P2 design"

  # --- Improvement 8_1: gnConv+SLIM P2 integrated ---
  gnconv_slim_p2_integrated:
    name: "(gnConv+SLIM-P2) Integrated"
    path: "Checkpoints - After improvements/8_1 - (gnConv+SLIMp2)/model (2).onnx"
    decoder_layers: 3
    backbone: "ResNet-18"
    category: "combined"
    description: "Integrated gnConv + SLIM P2 design"

  # --- EfficientNet-B2 Backbone ---
  efficientnet_b2:
    name: "EfficientNet-B2"
    path: "Checkpoints - After improvements/EfficientNet-B2/model_EFI.onnx"
    decoder_layers: 3
    backbone: "EfficientNet-B2"
    category: "backbone"
    description: "EfficientNet-B2 backbone replacement"

  # --- EfficientNet-B2 + P2 ---
  efficientnet_b2_p2:
    name: "EfficientNet-B2 + P2"
    path: "Checkpoints - After improvements/EfficientNet-B2+P2/model_EFI_P2.onnx"
    decoder_layers: 3
    backbone: "EfficientNet-B2"
    category: "backbone"
    description: "EfficientNet-B2 backbone + P2 layer"

# ============ Evaluation Settings ============
evaluation:
  input_size: [640, 640]         # [height, width]
  conf_threshold: 0.001          # Low threshold for mAP evaluation
  vis_conf_threshold: 0.25       # Higher threshold for visualization
  nms_threshold: 0.7
  max_detections: 300

# ============ Benchmark Settings ============
benchmark:
  warmup_iterations: 50
  measure_iterations: 200
